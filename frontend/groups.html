<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grupos - Astren</title>
    <meta name="description" content="Gestiona todos tus grupos en Astren - Organizados por áreas y miembros.">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Flatpickr DateTime Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css?v=6">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/groups.css?v=84">
    <link rel="stylesheet" href="css/notifications.css">
    
    <!-- CSS Crítico para evitar parpadeo -->
    <style>
        .group-card {
            background-color: hsl(var(--background));
            border: 2px solid hsl(var(--border));
            border-radius: var(--radius-xl);
            padding: 2.1rem 1.3rem 1.3rem 1.3rem;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-bottom: 0.7rem;
            width: 100%;
            max-width: 380px;
        }
        
        .group-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background-color: hsl(var(--border));
        }
        
        .group-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-large);
        }
        
        .tasks-grid, .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            justify-items: center;
            justify-content: center;
        }
        
        /* Estilos específicos para modales */
        #newGroupModal,
        #editGroupModal,
        #deleteConfirmModal,
        #groupMembersModal,
        #createGroupTaskModal {
            background: rgba(0, 0, 0, 0.5) !important;
            backdrop-filter: blur(4px) !important;
            z-index: 9999 !important;
        }
        
        #newGroupModal.active,
        #editGroupModal.active,
        #deleteConfirmModal.active,
        #groupMembersModal.active,
        #createGroupTaskModal.active {
            display: flex !important;
        }
        
        /* Asegurar que el contenido del modal tenga fondo blanco */
        #newGroupModal .modal-content,
        #editGroupModal .modal-content,
        #deleteConfirmModal .modal-content,
        #groupMembersModal .modal-content,
        #createGroupTaskModal .modal-content {
            background: white !important;
            border-radius: 12px !important;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1) !important;
        }
    </style>
</head>
<body class="dashboard-body">
    <div class="dashboard">
        <!-- El sidebar será inyectado dinámicamente por sidebar-new.js -->

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="dashboard__header">
                <div class="header__container">
                    <div class="header__left">
                        <button class="mobile-menu-btn" id="mobileMenuBtn">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h1 class="header__title">Grupos</h1>
                    </div>

                    <div class="header__right">
                        <div class="header__search">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Buscar grupos..." class="search__input">
                        </div>

                        <button class="header__notification">
                            <i class="fas fa-bell"></i>
                            <span class="notification__badge">3</span>
                        </button>

                        <div class="header__profile">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%233366FF'%3E%3Cpath fill-rule='evenodd' d='M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z' clip-rule='evenodd' /%3E%3C/svg%3E" alt="Avatar">
                        </div>
                    </div>
                </div>
            </header>

            <!-- Groups Content -->
            <div class="dashboard__content">
                <!-- Group Actions Bar -->
                <section class="groups-actions">
                    <div class="actions-left">
                        <button class="button button--primary" id="newGroupBtn">
                            <i class="fas fa-plus"></i>
                            Nuevo Grupo
                        </button>
                        
                        <div class="groups-filters">
                            <select class="filter-select" id="areaFilter">
                                <option value="">Todas las áreas</option>
                                <option value="personal">Personal</option>
                                <option value="work">Trabajo</option>
                                <option value="school">Escuela</option>
                            </select>
                            <select class="filter-select" id="statusFilter">
                                <option value="">Todos los estados</option>
                                <option value="active">Activos</option>
                                <option value="archived">Archivados</option>
                            </select>
                        </div>
                    </div>
                    <div class="actions-right">
                        <!-- Botones de vista eliminados -->
                    </div>
                </section>

                <!-- Group Stats (Contadores de estadísticas) -->
                <section class="groups-stats">
                    <div class="stat-item">
                        <div class="stat-icon stat-icon--total">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="totalGroups">0</span>
                            <span class="stat-label">Total Grupos</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon stat-icon--active">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="activeGroups">0</span>
                            <span class="stat-label">Grupos Activos</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon stat-icon--pending">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="invitations">0</span>
                            <span class="stat-label">Invitaciones Pendientes</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon stat-icon--archived">
                            <i class="fas fa-archive"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="archivedGroups">0</span>
                            <span class="stat-label">Grupos Archivados</span>
                        </div>
                    </div>
                </section>

                <!-- Groups List -->
                <section class="tasks-container">
                    <!-- Sección de Grupos Activos -->
                    <div class="tasks-section" id="active">
                        <h2 class="section-title">
                            <i class="fas fa-lightbulb"></i>
                            Grupos Activos
                        </h2>
                        <div class="tasks-grid" id="groupsGrid"></div>
                        <!-- Estado vacío para grupos activos -->
                        <div class="empty-state" id="emptyState" style="display: none;">
                        </div>
                    </div>

                    <!-- Sección de Invitaciones -->
                    <div class="tasks-section" id="invitations-section">
                        <h2 class="section-title">
                            <i class="fas fa-envelope"></i>
                            Invitaciones Pendientes
                        </h2>
                        <div class="tasks-grid" id="invitationsGrid"></div>

                    </div>

                    <!-- Botón de toggle para grupos archivados -->
                    <div class="archived-toggle-container">
                        <button class="toggle-section-btn" id="toggleArchivedGroupsBtn">
                            <i class="fas fa-chevron-down"></i>
                            Mostrar Grupos Archivados
                        </button>
                    </div>

                    <!-- Sección de Grupos Archivados -->
                    <div class="tasks-section" id="archived">
                        <h2 class="section-title">
                            <i class="fas fa-archive"></i>
                            Grupos Archivados
                        </h2>
                        <div class="tasks-grid" id="archivedGroupsGrid"></div>
                        <!-- Estado vacío para grupos archivados -->
                        <div class="empty-state" id="emptyArchivedState" style="display: none;">
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- New Group Modal -->
    <div class="modal" id="newGroupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Nuevo Grupo</h2>
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="task-form" id="newGroupForm">
                <div class="form-group">
                    <label for="groupName">Nombre del grupo</label>
                    <input type="text" id="groupName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="groupDescription">Descripción</label>
                    <textarea id="groupDescription" name="description" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="groupArea">Área</label>
                        <select id="groupArea" name="area" required>
                            <option value="">Seleccionar área</option>
                            <option value="personal">Área Personal</option>
                            <option value="work">Área Trabajo</option>
                            <option value="school">Área Escuela</option>
                        </select>
                    </div>
                </div>
                
                <!-- Color Picker -->
                <div class="form-group">
                    <label>Color del grupo</label>
                    <div class="color-picker">
                        <input type="radio" id="group-color-blue" name="groupColor" value="blue" checked>
                        <label for="group-color-blue" class="color-label color-blue" title="Azul"></label>
                        
                        <input type="radio" id="group-color-green" name="groupColor" value="green">
                        <label for="group-color-green" class="color-label color-green" title="Verde"></label>
                        
                        <input type="radio" id="group-color-purple" name="groupColor" value="purple">
                        <label for="group-color-purple" class="color-label color-purple" title="Morado"></label>
                        
                        <input type="radio" id="group-color-orange" name="groupColor" value="orange">
                        <label for="group-color-orange" class="color-label color-orange" title="Naranja"></label>
                        
                        <input type="radio" id="group-color-red" name="groupColor" value="red">
                        <label for="group-color-red" class="color-label color-red" title="Rojo"></label>
                        
                        <input type="radio" id="group-color-pink" name="groupColor" value="pink">
                        <label for="group-color-pink" class="color-label color-pink" title="Rosa"></label>
                        
                        <input type="radio" id="group-color-yellow" name="groupColor" value="yellow">
                        <label for="group-color-yellow" class="color-label color-yellow" title="Amarillo"></label>
                        
                        <input type="radio" id="group-color-mint" name="groupColor" value="mint">
                        <label for="group-color-mint" class="color-label color-mint" title="Menta"></label>
                        
                        <input type="radio" id="group-color-sky" name="groupColor" value="sky">
                        <label for="group-color-sky" class="color-label color-sky" title="Cielo"></label>
                        
                        <input type="radio" id="group-color-coral" name="groupColor" value="coral">
                        <label for="group-color-coral" class="color-label color-coral" title="Coral"></label>
                        
                        <input type="radio" id="group-color-lavender" name="groupColor" value="lavender">
                        <label for="group-color-lavender" class="color-label color-lavender" title="Lavanda"></label>
                    </div>
                </div>
                
                <!-- Icon Picker -->
                <div class="form-group">
                    <label>Icono del grupo</label>
                    <div class="icon-picker">
                        <input type="radio" id="group-icon-users" name="groupIcon" value="fa-users" checked>
                        <label for="group-icon-users" title="Usuarios"><i class="fas fa-users"></i></label>
                        
                        <input type="radio" id="group-icon-user-friends" name="groupIcon" value="fa-user-friends">
                        <label for="group-icon-user-friends" title="Amigos"><i class="fas fa-user-friends"></i></label>
                        
                        <input type="radio" id="group-icon-user-tie" name="groupIcon" value="fa-user-tie">
                        <label for="group-icon-user-tie" title="Profesional"><i class="fas fa-user-tie"></i></label>
                        
                        <input type="radio" id="group-icon-user-graduate" name="groupIcon" value="fa-user-graduate">
                        <label for="group-icon-user-graduate" title="Graduado"><i class="fas fa-user-graduate"></i></label>
                        
                        <input type="radio" id="group-icon-user-ninja" name="groupIcon" value="fa-user-ninja">
                        <label for="group-icon-user-ninja" title="Ninja"><i class="fas fa-user-ninja"></i></label>
                        
                        <input type="radio" id="group-icon-user-astronaut" name="groupIcon" value="fa-user-astronaut">
                        <label for="group-icon-user-astronaut" title="Astronauta"><i class="fas fa-user-astronaut"></i></label>
                        

                        
                        <input type="radio" id="group-icon-user-secret" name="groupIcon" value="fa-user-secret">
                        <label for="group-icon-user-secret" title="Secreto"><i class="fas fa-user-secret"></i></label>
                        
                        <input type="radio" id="group-icon-user-shield" name="groupIcon" value="fa-user-shield">
                        <label for="group-icon-user-shield" title="Escudo"><i class="fas fa-user-shield"></i></label>
                        
                        <input type="radio" id="group-icon-user-tag" name="groupIcon" value="fa-user-tag">
                        <label for="group-icon-user-tag" title="Etiqueta"><i class="fas fa-user-tag"></i></label>
                        
                        <input type="radio" id="group-icon-user-check" name="groupIcon" value="fa-user-check">
                        <label for="group-icon-user-check" title="Verificado"><i class="fas fa-user-check"></i></label>
                        
                        <input type="radio" id="group-icon-user-clock" name="groupIcon" value="fa-user-clock">
                        <label for="group-icon-user-clock" title="Reloj"><i class="fas fa-user-clock"></i></label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="button button--ghost" id="cancelGroup">Cancelar</button>
                    <button type="submit" class="button button--primary">Crear Grupo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmación para eliminar grupo -->
    <div class="modal" id="deleteConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>¿Eliminar grupo?</h2>
                <button class="modal-close" id="closeDeleteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>¿Estás seguro de que quieres eliminar este grupo? Esta acción no se puede deshacer.</p>
            </div>
            <div class="form-actions">
                <button type="button" class="button button--ghost" id="cancelDeleteGroup">Cancelar</button>
                <button type="button" class="button button--danger" id="confirmDeleteGroup">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmación para abandonar grupo -->
    <div class="modal" id="leaveConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>¿Abandonar grupo?</h2>
                <button class="modal-close" id="closeLeaveModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>¿Estás seguro de que quieres abandonar este grupo? Ya no tendrás acceso a las tareas y conversaciones del grupo.</p>
            </div>
            <div class="form-actions">
                <button type="button" class="button button--ghost" id="cancelLeaveGroup">Cancelar</button>
                <button type="button" class="button button--warning" id="confirmLeaveGroup">Abandonar</button>
            </div>
        </div>
    </div>

    <!-- Modal para editar grupo -->
    <div class="modal" id="editGroupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Editar Grupo</h2>
                <button class="modal-close" id="closeEditGroupModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="task-form" id="editGroupForm">
                <!-- Campo oculto necesario -->
                <input type="hidden" id="editGroupId" name="groupId">
                
                <div class="form-group">
                    <label for="editGroupName">Nombre del grupo</label>
                    <input type="text" id="editGroupName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="editGroupDescription">Descripción</label>
                    <textarea id="editGroupDescription" name="description" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editGroupArea">Área</label>
                        <select id="editGroupArea" name="area" required>
                            <option value="">Seleccionar área</option>
                            <option value="personal">Área Personal</option>
                            <option value="work">Área Trabajo</option>
                            <option value="school">Área Escuela</option>
                        </select>
                    </div>
                </div>
                
                <!-- Color Picker -->
                <div class="form-group">
                    <label>Color del grupo</label>
                    <div class="color-picker">
                        <input type="radio" id="edit-group-color-blue" name="editGroupColor" value="blue">
                        <label for="edit-group-color-blue" class="color-label color-blue" title="Azul"></label>
                        
                        <input type="radio" id="edit-group-color-green" name="editGroupColor" value="green">
                        <label for="edit-group-color-green" class="color-label color-green" title="Verde"></label>
                        
                        <input type="radio" id="edit-group-color-purple" name="editGroupColor" value="purple">
                        <label for="edit-group-color-purple" class="color-label color-purple" title="Morado"></label>
                        
                        <input type="radio" id="edit-group-color-orange" name="editGroupColor" value="orange">
                        <label for="edit-group-color-orange" class="color-label color-orange" title="Naranja"></label>
                        
                        <input type="radio" id="edit-group-color-red" name="editGroupColor" value="red">
                        <label for="edit-group-color-red" class="color-label color-red" title="Rojo"></label>
                        
                        <input type="radio" id="edit-group-color-pink" name="editGroupColor" value="pink">
                        <label for="edit-group-color-pink" class="color-label color-pink" title="Rosa"></label>
                        
                        <input type="radio" id="edit-group-color-yellow" name="editGroupColor" value="yellow">
                        <label for="edit-group-color-yellow" class="color-label color-yellow" title="Amarillo"></label>
                        
                        <input type="radio" id="edit-group-color-mint" name="editGroupColor" value="mint">
                        <label for="edit-group-color-mint" class="color-label color-mint" title="Menta"></label>
                        
                        <input type="radio" id="edit-group-color-sky" name="editGroupColor" value="sky">
                        <label for="edit-group-color-sky" class="color-label color-sky" title="Cielo"></label>
                        
                        <input type="radio" id="edit-group-color-coral" name="editGroupColor" value="coral">
                        <label for="edit-group-color-coral" class="color-label color-coral" title="Coral"></label>
                        
                        <input type="radio" id="edit-group-color-lavender" name="editGroupColor" value="lavender">
                        <label for="edit-group-color-lavender" class="color-label color-lavender" title="Lavanda"></label>
                    </div>
                </div>
                
                <!-- Icon Picker -->
                <div class="form-group">
                    <label>Icono del grupo</label>
                    <div class="icon-picker">
                        <input type="radio" id="edit-group-icon-users" name="editGroupIcon" value="fa-users">
                        <label for="edit-group-icon-users" title="Usuarios"><i class="fas fa-users"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-friends" name="editGroupIcon" value="fa-user-friends">
                        <label for="edit-group-icon-user-friends" title="Amigos"><i class="fas fa-user-friends"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-tie" name="editGroupIcon" value="fa-user-tie">
                        <label for="edit-group-icon-user-tie" title="Profesional"><i class="fas fa-user-tie"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-graduate" name="editGroupIcon" value="fa-user-graduate">
                        <label for="edit-group-icon-user-graduate" title="Graduado"><i class="fas fa-user-graduate"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-ninja" name="editGroupIcon" value="fa-user-ninja">
                        <label for="edit-group-icon-user-ninja" title="Ninja"><i class="fas fa-user-ninja"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-astronaut" name="editGroupIcon" value="fa-user-astronaut">
                        <label for="edit-group-icon-user-astronaut" title="Astronauta"><i class="fas fa-user-astronaut"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-secret" name="editGroupIcon" value="fa-user-secret">
                        <label for="edit-group-icon-user-secret" title="Secreto"><i class="fas fa-user-secret"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-shield" name="editGroupIcon" value="fa-user-shield">
                        <label for="edit-group-icon-user-shield" title="Escudo"><i class="fas fa-user-shield"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-tag" name="editGroupIcon" value="fa-user-tag">
                        <label for="edit-group-icon-user-tag" title="Etiqueta"><i class="fas fa-user-tag"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-check" name="editGroupIcon" value="fa-user-check">
                        <label for="edit-group-icon-user-check" title="Verificado"><i class="fas fa-user-check"></i></label>
                        
                        <input type="radio" id="edit-group-icon-user-clock" name="editGroupIcon" value="fa-user-clock">
                        <label for="edit-group-icon-user-clock" title="Reloj"><i class="fas fa-user-clock"></i></label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="button button--ghost" id="cancelEditGroup">Cancelar</button>
                    <button type="submit" class="button button--primary">Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para ver miembros del grupo -->
    <div class="modal" id="groupMembersModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Miembros del Grupo</h2>
                <button class="modal-close" id="closeGroupMembersModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="groupMembersList"></div>
                <div class="add-member-section">
                    <h3>Invitar Miembro</h3>
                    <form id="addMemberForm">
                        <div class="form-group">
                            <label for="memberEmail">Email del usuario</label>
                            <input type="email" id="memberEmail" name="memberEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="memberRole">Rol</label>
                            <select id="memberRole" name="memberRole" required>
                                <option value="miembro">Miembro</option>
                                <option value="administrador">Administrador</option>
                                <option value="lider">Líder</option>
                            </select>
                        </div>
                        <button type="submit" class="button button--primary">Invitar Miembro</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para cambiar rol de miembro -->
    <div class="modal" id="changeRoleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Cambiar Rol de Miembro</h2>
                <button class="modal-close" id="closeChangeRoleModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="task-form" id="changeRoleForm">
                <input type="hidden" id="changeRoleUserId" name="userId">
                <input type="hidden" id="changeRoleGroupId" name="groupId">
                
                <div class="form-group">
                    <label for="changeRoleSelect">Nuevo Rol</label>
                    <select id="changeRoleSelect" name="newRole" required>
                        <option value="lider">Líder</option>
                        <option value="administrador">Administrador</option>
                        <option value="miembro">Miembro</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="button button--ghost" id="cancelChangeRole">Cancelar</button>
                    <button type="submit" class="button button--primary">Cambiar Rol</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para crear tarea en grupo -->
    <div class="modal" id="createGroupTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Crear Tarea en Grupo</h2>
                <button class="modal-close" id="closeCreateGroupTaskModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="task-form" id="createGroupTaskForm">
                <!-- Campos ocultos necesarios -->
                <input type="hidden" id="taskGroupId" name="groupId">
                <input type="hidden" id="taskUserId" name="userId">
                
                <div class="form-group">
                    <label for="groupTaskTitle">Título de la tarea</label>
                    <input type="text" id="groupTaskTitle" name="title" required>
                </div>
                <div class="form-group">
                    <label for="groupTaskDescription">Descripción</label>
                    <textarea id="groupTaskDescription" name="description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="groupTaskDueDate">Fecha de vencimiento</label>
                    <input type="text" id="groupTaskDueDate" name="dueDate" placeholder="">
                </div>
                
                <!-- Opciones de asignación -->
                <div class="form-group">
                    <label>Asignar tarea a:</label>
                    <div class="assignment-options">
                        <div class="assignment-option">
                            <input type="radio" id="assignToSelf" name="assignmentType" value="self" checked>
                            <label for="assignToSelf">Solo para mí</label>
                        </div>
                        <div class="assignment-option">
                            <input type="radio" id="assignToAll" name="assignmentType" value="all">
                            <label for="assignToAll">Todos los miembros del grupo</label>
                        </div>
                        <div class="assignment-option">
                            <input type="radio" id="assignToSpecific" name="assignmentType" value="specific">
                            <label for="assignToSpecific">Miembros específicos</label>
                        </div>
                    </div>
                </div>
                
                <!-- Sección de miembros específicos (inicialmente oculta) -->
                <div id="specificMembersSection" style="display: none;">
                    <div class="form-group">
                        <label>Seleccionar miembros:</label>
                        <div id="memberSelection"></div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="button button--ghost" id="cancelCreateGroupTask">Cancelar</button>
                    <button type="submit" class="button button--primary">Crear Tarea</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para aceptar invitación -->
    <div class="modal" id="acceptInvitationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Aceptar Invitación</h2>
                <button class="modal-close" id="closeAcceptInvitationModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="task-form">
                <div class="form-group">
                    <label for="acceptInvitationArea">Asignar a área (opcional)</label>
                    <select id="acceptInvitationArea" name="area">
                        <option value="">Selecciona un área (opcional)</option>
                    </select>
                    <small class="form-help">Puedes asignar este grupo a una de tus áreas personales para organizarlo mejor.</small>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="button button--ghost" id="cancelAcceptInvitation">Cancelar</button>
                    <button type="button" class="button button--primary" id="confirmAcceptInvitation">Aceptar Invitación</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/sidebar-new.js"></script>
    <script src="js/scripts.js"></script>
    <script src="js/groups.js?v=77"></script>
    <script src="js/header-buttons.js"></script>
    <script src="js/notifications.js"></script>
</body>
</html>